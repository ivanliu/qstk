<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>QSTK.qstkfeat.featutil</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="QSTK-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >QSTK</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="QSTK-module.html">Package&nbsp;QSTK</a> ::
        <a href="QSTK.qstkfeat-module.html">Package&nbsp;qstkfeat</a> ::
        Module&nbsp;featutil
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="QSTK.qstkfeat.featutil-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="QSTK.qstkfeat.featutil-module.html">Module QSTK.qstkfeat.featutil</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-docstring">'''</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-docstring">(c) 2011, 2012 Georgia Tech Research Corporation</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-docstring">This source code is released under the New BSD license.  Please see</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-docstring">http://wiki.quantsoftware.org/index.php?title=QSTK_License</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-docstring">for license details.</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-docstring">Created on Nov 7, 2011</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-docstring">@author: John Cornwell</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-docstring">@contact: JohnWCornwellV@gmail.com</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-docstring">@summary: Contains utility functions to interact with feature functions in features.py</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-docstring">'''</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-string">''' Python imports '''</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">math</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">pickle</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">datetime</tt> <tt class="py-keyword">as</tt> <tt class="py-name">dt</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Module QSTK.qstkutil.dateutil=QSTK.qstkutil.dateutil-module.html"><a title="QSTK.qstkutil.dateutil" class="py-name" href="#" onclick="return doclink('link-0', 'dateutil', 'link-0');">dateutil</a></tt><tt class="py-op">.</tt><tt class="py-name">relativedelta</tt> <tt class="py-keyword">import</tt> <tt class="py-name">relativedelta</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-string">''' 3rd Party Imports '''</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">as</tt> <tt class="py-name">np</tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">matplotlib</tt><tt class="py-op">.</tt><tt class="py-name">pyplot</tt> <tt class="py-keyword">as</tt> <tt class="py-name">plt</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-string">''' Our Imports '''</tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt id="link-1" class="py-name" targets="Package QSTK.qstklearn=QSTK.qstklearn-module.html"><a title="QSTK.qstklearn" class="py-name" href="#" onclick="return doclink('link-1', 'qstklearn', 'link-1');">qstklearn</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Module QSTK.qstklearn.kdtknn=QSTK.qstklearn.kdtknn-module.html,Class QSTK.qstklearn.kdtknn.kdtknn=QSTK.qstklearn.kdtknn.kdtknn-class.html"><a title="QSTK.qstklearn.kdtknn
QSTK.qstklearn.kdtknn.kdtknn" class="py-name" href="#" onclick="return doclink('link-2', 'kdtknn', 'link-2');">kdtknn</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">kdt</tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-3" class="py-name" targets="Package QSTK.qstkutil=QSTK.qstkutil-module.html"><a title="QSTK.qstkutil" class="py-name" href="#" onclick="return doclink('link-3', 'qstkutil', 'link-3');">qstkutil</a></tt> <tt class="py-keyword">import</tt> <tt id="link-4" class="py-name" targets="Module QSTK.qstkutil.DataAccess=QSTK.qstkutil.DataAccess-module.html,Class QSTK.qstkutil.DataAccess.DataAccess=QSTK.qstkutil.DataAccess.DataAccess-class.html"><a title="QSTK.qstkutil.DataAccess
QSTK.qstkutil.DataAccess.DataAccess" class="py-name" href="#" onclick="return doclink('link-4', 'DataAccess', 'link-4');">DataAccess</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">da</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-5" class="py-name"><a title="QSTK.qstkutil" class="py-name" href="#" onclick="return doclink('link-5', 'qstkutil', 'link-3');">qstkutil</a></tt> <tt class="py-keyword">import</tt> <tt id="link-6" class="py-name"><a title="QSTK.qstkutil.dateutil" class="py-name" href="#" onclick="return doclink('link-6', 'dateutil', 'link-0');">dateutil</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">du</tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-7" class="py-name"><a title="QSTK.qstkutil" class="py-name" href="#" onclick="return doclink('link-7', 'qstkutil', 'link-3');">qstkutil</a></tt> <tt class="py-keyword">import</tt> <tt id="link-8" class="py-name" targets="Module QSTK.qstkutil.tsutil=QSTK.qstkutil.tsutil-module.html"><a title="QSTK.qstkutil.tsutil" class="py-name" href="#" onclick="return doclink('link-8', 'tsutil', 'link-8');">tsutil</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">tsu</tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-9" class="py-name" targets="Package QSTK.qstkfeat=QSTK.qstkfeat-module.html"><a title="QSTK.qstkfeat" class="py-name" href="#" onclick="return doclink('link-9', 'qstkfeat', 'link-9');">qstkfeat</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name" targets="Module QSTK.qstkfeat.features=QSTK.qstkfeat.features-module.html"><a title="QSTK.qstkfeat.features" class="py-name" href="#" onclick="return doclink('link-10', 'features', 'link-10');">features</a></tt> <tt class="py-keyword">import</tt> <tt class="py-op">*</tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-11" class="py-name"><a title="QSTK.qstkfeat" class="py-name" href="#" onclick="return doclink('link-11', 'qstkfeat', 'link-9');">qstkfeat</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name" targets="Module QSTK.qstkfeat.classes=QSTK.qstkfeat.classes-module.html"><a title="QSTK.qstkfeat.classes" class="py-name" href="#" onclick="return doclink('link-12', 'classes', 'link-12');">classes</a></tt> <tt class="py-keyword">import</tt> <tt id="link-13" class="py-name" targets="Function QSTK.qstkfeat.classes.classFutRet()=QSTK.qstkfeat.classes-module.html#classFutRet"><a title="QSTK.qstkfeat.classes.classFutRet" class="py-name" href="#" onclick="return doclink('link-13', 'classFutRet', 'link-13');">classFutRet</a></tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"> </tt>
<a name="getMarketRel"></a><div id="getMarketRel-def"><a name="L35"></a><tt class="py-lineno"> 35</tt> <a class="py-toggle" href="#" id="getMarketRel-toggle" onclick="return toggle('getMarketRel');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#getMarketRel">getMarketRel</a><tt class="py-op">(</tt> <tt class="py-param">dData</tt><tt class="py-op">,</tt> <tt class="py-param">sRel</tt><tt class="py-op">=</tt><tt class="py-string">'$SPX'</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="getMarketRel-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="getMarketRel-expanded"><a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Calculates market relative data.</tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-docstring">        @param dData - Dictionary containing data to be used, requires specific naming: open/high/low/close/volume</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-docstring">        @param sRel - Stock ticker to make the data relative to, $SPX is default.</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-docstring">        @return: Dictionary of market relative values</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line">         </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">sRel</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dData</tt><tt class="py-op">[</tt><tt class="py-string">'close'</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">:</tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt class="py-name">KeyError</tt><tt class="py-op">(</tt> <tt class="py-string">'Market relative stock %s not found in getMR()'</tt><tt class="py-op">%</tt><tt class="py-name">sRel</tt> <tt class="py-op">)</tt> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line">         </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line">         </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line">        <tt class="py-name">dRet</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line">            </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line">        <tt class="py-string">''' Make all data market relative, except for volume '''</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">sKey</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dData</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line">                 </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line">                <tt class="py-string">''' Don't calculate market relative volume, but still copy it over '''</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">sKey</tt> <tt class="py-op">==</tt> <tt class="py-string">'volume'</tt><tt class="py-op">:</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line">                        <tt class="py-name">dRet</tt><tt class="py-op">[</tt><tt class="py-string">'volume'</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">dData</tt><tt class="py-op">[</tt><tt class="py-string">'volume'</tt><tt class="py-op">]</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line">                        <tt class="py-keyword">continue</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">                 </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line">                <tt class="py-name">dfAbsolute</tt> <tt class="py-op">=</tt> <tt class="py-name">dData</tt><tt class="py-op">[</tt><tt class="py-name">sKey</tt><tt class="py-op">]</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line">                <tt class="py-name">dfRelative</tt> <tt class="py-op">=</tt> <tt class="py-name">pand</tt><tt class="py-op">.</tt><tt class="py-name">DataFrame</tt><tt class="py-op">(</tt> <tt class="py-name">index</tt><tt class="py-op">=</tt><tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">,</tt> <tt class="py-name">columns</tt><tt class="py-op">=</tt><tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">,</tt> <tt id="link-14" class="py-name" targets="Variable QSTK.qstklearn.parallelknn.data=QSTK.qstklearn.parallelknn-module.html#data"><a title="QSTK.qstklearn.parallelknn.data" class="py-name" href="#" onclick="return doclink('link-14', 'data', 'link-14');">data</a></tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">                 </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">                <tt class="py-string">''' Get returns and strip off the market returns '''</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line">                <tt class="py-name">naRets</tt> <tt class="py-op">=</tt> <tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">.</tt><tt class="py-name">copy</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">                <tt class="py-name">tsu</tt><tt class="py-op">.</tt><tt id="link-15" class="py-name" targets="Function QSTK.qstkutil.tsutil.returnize0()=QSTK.qstkutil.tsutil-module.html#returnize0"><a title="QSTK.qstkutil.tsutil.returnize0" class="py-name" href="#" onclick="return doclink('link-15', 'returnize0', 'link-15');">returnize0</a></tt><tt class="py-op">(</tt> <tt class="py-name">naRets</tt> <tt class="py-op">)</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">                 </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">                <tt class="py-name">naMarkRets</tt> <tt class="py-op">=</tt> <tt class="py-name">naRets</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt> <tt class="py-name">list</tt><tt class="py-op">(</tt><tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">(</tt><tt class="py-name">sRel</tt><tt class="py-op">)</tt> <tt class="py-op">]</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">                 </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-16" class="py-name" targets="Variable QSTK.Bin.gen_nyse_dates.i=QSTK.Bin.gen_nyse_dates-module.html#i"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-16', 'i', 'link-16');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">sStock</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">                        <tt class="py-string">''' Don't change the 'market' stock '''</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt class="py-name">sStock</tt> <tt class="py-op">==</tt> <tt class="py-name">sRel</tt><tt class="py-op">:</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">                                <tt class="py-name">dfRelative</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-17" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-17', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-18" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-18', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">                                <tt class="py-keyword">continue</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">         </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">                        <tt class="py-name">naMarkRel</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">naRets</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-19" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-19', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">-</tt> <tt class="py-name">naMarkRets</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-number">1.0</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line"> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">                        <tt class="py-string">''' Find the first non-nan value and start the price at 100 '''</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">                        <tt class="py-keyword">for</tt> <tt id="link-20" class="py-name" targets="Variable QSTK.Bin.gen_nyse_dates.j=QSTK.Bin.gen_nyse_dates-module.html#j"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-20', 'j', 'link-20');">j</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">                                <tt class="py-keyword">if</tt> <tt class="py-name">pand</tt><tt class="py-op">.</tt><tt class="py-name">isnull</tt><tt class="py-op">(</tt> <tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt id="link-21" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-21', 'j', 'link-20');">j</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-22" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-22', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">                                        <tt class="py-name">dfRelative</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt id="link-23" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-23', 'j', 'link-20');">j</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-24" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-24', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">float</tt><tt class="py-op">(</tt><tt class="py-string">'nan'</tt><tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line">                                        <tt class="py-keyword">continue</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">                                <tt class="py-name">dfRelative</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt id="link-25" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-25', 'j', 'link-20');">j</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-26" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-26', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-number">100</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">                                <tt class="py-keyword">break</tt> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">                                 </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">                        <tt class="py-string">''' Now fill prices out using market relative returns '''</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">                        <tt class="py-keyword">for</tt> <tt id="link-27" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-27', 'j', 'link-20');">j</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt id="link-28" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-28', 'j', 'link-20');">j</a></tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">dfAbsolute</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">                                <tt class="py-name">dfRelative</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt id="link-29" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-29', 'j', 'link-20');">j</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-30" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-30', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt>  <tt class="py-name">dfRelative</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt id="link-31" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-31', 'j', 'link-20');">j</a></tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt id="link-32" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-32', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-name">naMarkRel</tt><tt class="py-op">[</tt><tt id="link-33" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.j" class="py-name" href="#" onclick="return doclink('link-33', 'j', 'link-20');">j</a></tt><tt class="py-op">]</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">                 </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">                <tt class="py-string">''' Add dataFrame to dictionary to return, move to next key '''</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">                <tt class="py-name">dRet</tt><tt class="py-op">[</tt><tt class="py-name">sKey</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">dfRelative</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">                 </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">                 </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">dRet</tt> </tt>
</div><a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line"> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line"> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line"> </tt>
<a name="applyFeatures"></a><div id="applyFeatures-def"><a name="L94"></a><tt class="py-lineno"> 94</tt> <a class="py-toggle" href="#" id="applyFeatures-toggle" onclick="return toggle('applyFeatures');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#applyFeatures">applyFeatures</a><tt class="py-op">(</tt> <tt class="py-param">dData</tt><tt class="py-op">,</tt> <tt class="py-param">lfcFeatures</tt><tt class="py-op">,</tt> <tt class="py-param">ldArgs</tt><tt class="py-op">,</tt> <tt class="py-param">sMarketRel</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">sLog</tt><tt class="py-op">=</tt><tt class="py-name">None</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="applyFeatures-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="applyFeatures-expanded"><a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Calculates the feature values using a list of feature functions and arguments.</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line"><tt class="py-docstring">        @param dData - Dictionary containing data to be used, requires specific naming: open/high/low/close/volume</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line"><tt class="py-docstring">        @param lfcFeatures: List of feature functions, most likely coming from features.py</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"><tt class="py-docstring">        @param ldArgs: List of dictionaries containing arguments, passed as **kwargs</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line"><tt class="py-docstring">                                   There is a special argument 'MR', if it exists, the data will be made market relative</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line"><tt class="py-docstring">        @param sMarketRel: If not none, the data will all be made relative to the symbol provided</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line"><tt class="py-docstring">        @param sLog: If not None, will be filename to log all of the features to </tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line"><tt class="py-docstring">        @return: list of dataframes containing values</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line"> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line"> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line"> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">                 </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">        <tt class="py-name">ldfRet</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">         </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">        <tt class="py-string">''' Calculate market relative data '''</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">sMarketRel</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">                <tt class="py-name">dDataRelative</tt> <tt class="py-op">=</tt> <tt id="link-34" class="py-name" targets="Function QSTK.qstkfeat.featutil.getMarketRel()=QSTK.qstkfeat.featutil-module.html#getMarketRel"><a title="QSTK.qstkfeat.featutil.getMarketRel" class="py-name" href="#" onclick="return doclink('link-34', 'getMarketRel', 'link-34');">getMarketRel</a></tt><tt class="py-op">(</tt> <tt class="py-name">dData</tt><tt class="py-op">,</tt> <tt class="py-name">sRel</tt><tt class="py-op">=</tt><tt class="py-name">sMarketRel</tt> <tt class="py-op">)</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">         </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">         </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">        <tt class="py-string">''' Loop though feature functions, pass each data dictionary and arguments '''</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-35" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-35', 'i', 'link-16');">i</a></tt><tt class="py-op">,</tt> <tt class="py-name">fcFeature</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">lfcFeatures</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">                 </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">                <tt class="py-string">''' Check for special arguments '''</tt> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-string">'MR'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">ldArgs</tt><tt class="py-op">[</tt><tt id="link-36" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-36', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">                         </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt class="py-name">ldArgs</tt><tt class="py-op">[</tt><tt id="link-37" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-37', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-string">'MR'</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">False</tt><tt class="py-op">:</tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">                                <tt class="py-keyword">print</tt> <tt class="py-string">'Warning, setting MR to false will still be Market Relative'</tt><tt class="py-op">,</tt>\ </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">                                          <tt class="py-string">'simply do not include MR key in args'</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line">                 </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt class="py-name">sMarketRel</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">                                <tt class="py-keyword">raise</tt> <tt class="py-name">AssertionError</tt><tt class="py-op">(</tt><tt class="py-string">'Functions require market relative stock but sMarketRel=None'</tt><tt class="py-op">)</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">                        <tt class="py-keyword">del</tt> <tt class="py-name">ldArgs</tt><tt class="py-op">[</tt><tt id="link-38" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-38', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-string">'MR'</tt><tt class="py-op">]</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">                        <tt class="py-name">ldfRet</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt> <tt class="py-name">fcFeature</tt><tt class="py-op">(</tt> <tt class="py-name">dDataRelative</tt><tt class="py-op">,</tt> <tt class="py-op">**</tt><tt class="py-name">ldArgs</tt><tt class="py-op">[</tt><tt id="link-39" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-39', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line">                        <tt class="py-name">ldfRet</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt> <tt class="py-name">fcFeature</tt><tt class="py-op">(</tt> <tt class="py-name">dData</tt><tt class="py-op">,</tt> <tt class="py-op">**</tt><tt class="py-name">ldArgs</tt><tt class="py-op">[</tt><tt id="link-40" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-40', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line"> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line">                 </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">sLog</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line">                <tt class="py-keyword">with</tt> <tt class="py-name">open</tt><tt class="py-op">(</tt> <tt class="py-name">sLog</tt><tt class="py-op">,</tt> <tt class="py-string">'wb'</tt> <tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">fFile</tt><tt class="py-op">:</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line">                        <tt class="py-name">pickle</tt><tt class="py-op">.</tt><tt class="py-name">dump</tt><tt class="py-op">(</tt> <tt class="py-name">ldfRet</tt><tt class="py-op">,</tt> <tt class="py-name">fFile</tt><tt class="py-op">,</tt> <tt class="py-op">-</tt><tt class="py-number">1</tt> <tt class="py-op">)</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">                 </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">ldfRet</tt> </tt>
</div><a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line"> </tt>
<a name="loadFeatures"></a><div id="loadFeatures-def"><a name="L140"></a><tt class="py-lineno">140</tt> <a class="py-toggle" href="#" id="loadFeatures-toggle" onclick="return toggle('loadFeatures');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#loadFeatures">loadFeatures</a><tt class="py-op">(</tt> <tt class="py-param">sLog</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="loadFeatures-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="loadFeatures-expanded"><a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Loads cached features.</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line"><tt class="py-docstring">        @param sLog: Filename of features.</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line"><tt class="py-docstring">        @return: Numpy array containing values</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">         </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line">        <tt class="py-name">ldfRet</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">         </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">sLog</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">                <tt class="py-keyword">with</tt> <tt class="py-name">open</tt><tt class="py-op">(</tt> <tt class="py-name">sLog</tt><tt class="py-op">,</tt> <tt class="py-string">'rb'</tt> <tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">fFile</tt><tt class="py-op">:</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">                        <tt class="py-name">ldfRet</tt> <tt class="py-op">=</tt> <tt class="py-name">pickle</tt><tt class="py-op">.</tt><tt class="py-name">load</tt><tt class="py-op">(</tt> <tt class="py-name">fFile</tt> <tt class="py-op">)</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">                 </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">ldfRet</tt> </tt>
</div><a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line"> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line"> </tt>
<a name="stackSyms"></a><div id="stackSyms-def"><a name="L156"></a><tt class="py-lineno">156</tt> <a class="py-toggle" href="#" id="stackSyms-toggle" onclick="return toggle('stackSyms');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#stackSyms">stackSyms</a><tt class="py-op">(</tt> <tt class="py-param">ldfFeatures</tt><tt class="py-op">,</tt> <tt class="py-param">dtStart</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">dtEnd</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">lsSym</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">bDelNan</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> <tt class="py-param">bShowRemoved</tt><tt class="py-op">=</tt><tt class="py-name">False</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="stackSyms-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="stackSyms-expanded"><a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Remove symbols from the dataframes, effectively stacking all stocks on top of each other.</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line"><tt class="py-docstring">        @param ldfFeatures: List of data frames of features.</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line"><tt class="py-docstring">        @param dtStart: Start time, if None, uses all</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line"><tt class="py-docstring">        @param dtEnd: End time, if None uses all</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line"><tt class="py-docstring">        @param lsSym: List of symbols to use, if None, all are used.</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line"><tt class="py-docstring">        @param bDelNan: Optional, default is true: delete all rows with a NaN in it</tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line"><tt class="py-docstring">        @return: Numpy array containing all features as columns and all </tt> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">         </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">dtStart</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line">                <tt class="py-name">dtStart</tt> <tt class="py-op">=</tt> <tt class="py-name">ldfFeatures</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">dtEnd</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">                <tt class="py-name">dtEnd</tt> <tt class="py-op">=</tt> <tt class="py-name">ldfFeatures</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">         </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">        <tt class="py-name">naRet</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">        <tt class="py-string">''' Stack stocks vertically '''</tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">sStock</tt> <tt class="py-keyword">in</tt> <tt class="py-name">ldfFeatures</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">:</tt> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">                 </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">lsSym</tt> <tt class="py-op">!=</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-name">sStock</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">lsSym</tt><tt class="py-op">:</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">                        <tt class="py-keyword">continue</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line"> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">                <tt class="py-name">naStkData</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">                <tt class="py-string">''' Loop through all features, stacking columns horizontally '''</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">dfFeat</tt> <tt class="py-keyword">in</tt> <tt class="py-name">ldfFeatures</tt><tt class="py-op">:</tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">                         </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">                        <tt class="py-name">dfFeat</tt> <tt class="py-op">=</tt> <tt class="py-name">dfFeat</tt><tt class="py-op">.</tt><tt class="py-name">ix</tt><tt class="py-op">[</tt><tt class="py-name">dtStart</tt><tt class="py-op">:</tt><tt class="py-name">dtEnd</tt><tt class="py-op">]</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">                         </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt class="py-name">naStkData</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">                                <tt class="py-name">naStkData</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">array</tt><tt class="py-op">(</tt> <tt class="py-name">dfFeat</tt><tt class="py-op">[</tt><tt class="py-name">sStock</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">.</tt><tt class="py-name">reshape</tt><tt class="py-op">(</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">                        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">                                <tt class="py-name">naStkData</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">hstack</tt><tt class="py-op">(</tt> <tt class="py-op">(</tt><tt class="py-name">naStkData</tt><tt class="py-op">,</tt> <tt class="py-name">dfFeat</tt><tt class="py-op">[</tt><tt class="py-name">sStock</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">.</tt><tt class="py-name">reshape</tt><tt class="py-op">(</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt><tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">    </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">                <tt class="py-string">''' Remove nan rows possibly'''</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">True</tt> <tt class="py-op">==</tt> <tt class="py-name">bDelNan</tt><tt class="py-op">:</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">                        <tt class="py-name">llValidRows</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line">                        <tt class="py-keyword">for</tt> <tt id="link-41" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-41', 'i', 'link-16');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">naStkData</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line">                                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">math</tt><tt class="py-op">.</tt><tt id="link-42" class="py-name" targets="Variable QSTK.Bin.converter.isnan=QSTK.Bin.converter-module.html#isnan,Variable QSTK.Bin.report.isnan=QSTK.Bin.report-module.html#isnan,Variable QSTK.qstklearn.mldiagnostics.isnan=QSTK.qstklearn.mldiagnostics-module.html#isnan,Variable QSTK.qstkutil.bollinger.isnan=QSTK.qstkutil.bollinger-module.html#isnan,Variable QSTK.qstkutil.tsutil.isnan=QSTK.qstkutil.tsutil-module.html#isnan,Variable QSTK.quicksim.quickSim.isnan=QSTK.quicksim.quickSim-module.html#isnan"><a title="QSTK.Bin.converter.isnan
QSTK.Bin.report.isnan
QSTK.qstklearn.mldiagnostics.isnan
QSTK.qstkutil.bollinger.isnan
QSTK.qstkutil.tsutil.isnan
QSTK.quicksim.quickSim.isnan" class="py-name" href="#" onclick="return doclink('link-42', 'isnan', 'link-42');">isnan</a></tt><tt class="py-op">(</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">sum</tt><tt class="py-op">(</tt><tt class="py-name">naStkData</tt><tt class="py-op">[</tt><tt id="link-43" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-43', 'i', 'link-16');">i</a></tt><tt class="py-op">,</tt><tt class="py-op">:</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">                                        <tt class="py-name">llValidRows</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt id="link-44" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-44', 'i', 'link-16');">i</a></tt><tt class="py-op">)</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">                                <tt class="py-keyword">elif</tt> <tt class="py-name">bShowRemoved</tt><tt class="py-op">:</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line">                                        <tt class="py-keyword">print</tt> <tt class="py-string">'Removed'</tt><tt class="py-op">,</tt> <tt class="py-name">sStock</tt><tt class="py-op">,</tt> <tt class="py-name">naStkData</tt><tt class="py-op">[</tt><tt id="link-45" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-45', 'i', 'link-16');">i</a></tt><tt class="py-op">,</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">                                         </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line">                        <tt class="py-name">naStkData</tt> <tt class="py-op">=</tt> <tt class="py-name">naStkData</tt><tt class="py-op">[</tt><tt class="py-name">llValidRows</tt><tt class="py-op">,</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">                         </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">         </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line">                <tt class="py-string">''' Now stack each block of stock data vertically '''</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">naRet</tt> <tt class="py-op">==</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">                        <tt class="py-name">naRet</tt> <tt class="py-op">=</tt> <tt class="py-name">naStkData</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line">                        <tt class="py-name">naRet</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">vstack</tt><tt class="py-op">(</tt> <tt class="py-op">(</tt><tt class="py-name">naRet</tt><tt class="py-op">,</tt> <tt class="py-name">naStkData</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line"> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">naRet</tt> </tt>
</div><a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line"> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line"> </tt>
<a name="normFeatures"></a><div id="normFeatures-def"><a name="L211"></a><tt class="py-lineno">211</tt> <a class="py-toggle" href="#" id="normFeatures-toggle" onclick="return toggle('normFeatures');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#normFeatures">normFeatures</a><tt class="py-op">(</tt> <tt class="py-param">naFeatures</tt><tt class="py-op">,</tt> <tt class="py-param">fMin</tt><tt class="py-op">,</tt> <tt class="py-param">fMax</tt><tt class="py-op">,</tt> <tt class="py-param">bAbsolute</tt><tt class="py-op">,</tt> <tt class="py-param">bIgnoreLast</tt><tt class="py-op">=</tt><tt class="py-name">True</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="normFeatures-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="normFeatures-expanded"><a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Normalizes the featurespace.</tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line"><tt class="py-docstring">        @param naFeatures:  Numpy array of features,  </tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line"><tt class="py-docstring">        @param fMin: Data frame containing the price information for all of the stocks.</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line"><tt class="py-docstring">        @param fMax: List of feature functions, most likely coming from features.py</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line"><tt class="py-docstring">        @param bAbsolute: If true, min value will be scaled to fMin, max to fMax, if false,</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line"><tt class="py-docstring">                                          +-1 standard deviations will be scaled to fit between fMin and fMax, i.e. ~69% of the values</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line"><tt class="py-docstring">        @param bIgnoreLast: If true, last column is ignored (assumed to be classification)</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line"><tt class="py-docstring">        @return: list of (weights, shifts) to be used to normalize the query points</tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">         </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">        <tt class="py-name">fNewRange</tt> <tt class="py-op">=</tt> <tt class="py-name">fMax</tt> <tt class="py-op">-</tt> <tt class="py-name">fMin</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line">         </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line">        <tt class="py-name">lUseCols</tt> <tt class="py-op">=</tt> <tt class="py-name">naFeatures</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">bIgnoreLast</tt><tt class="py-op">:</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">                <tt class="py-name">lUseCols</tt> <tt class="py-op">-=</tt> <tt class="py-number">1</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">         </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line">        <tt class="py-name">ltRet</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line">        <tt class="py-string">''' Loop through all features '''</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-46" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-46', 'i', 'link-16');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">lUseCols</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line">                 </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line">                <tt class="py-string">''' If absolutely scaled use exact min and max '''</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">bAbsolute</tt><tt class="py-op">:</tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">                        <tt class="py-name">fFeatMin</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">min</tt><tt class="py-op">(</tt> <tt class="py-name">naFeatures</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-47" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-47', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">)</tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">                        <tt class="py-name">fFeatMax</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">max</tt><tt class="py-op">(</tt> <tt class="py-name">naFeatures</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-48" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-48', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">)</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line">                        <tt class="py-string">''' Otherwise use mean +-1 std deviations for min/max (~94% of data) '''</tt> </tt>
<a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line">                        <tt class="py-name">fMean</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">average</tt><tt class="py-op">(</tt> <tt class="py-name">naFeatures</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-49" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-49', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">)</tt> </tt>
<a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line">                        <tt class="py-name">fStd</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">std</tt><tt class="py-op">(</tt> <tt class="py-name">naFeatures</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-50" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-50', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">)</tt>  </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">                        <tt class="py-name">fFeatMin</tt> <tt class="py-op">=</tt> <tt class="py-name">fMean</tt> <tt class="py-op">-</tt> <tt class="py-name">fStd</tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line">                        <tt class="py-name">fFeatMax</tt> <tt class="py-op">=</tt> <tt class="py-name">fMean</tt> <tt class="py-op">+</tt> <tt class="py-name">fStd</tt> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line">                         </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">                <tt class="py-string">''' Calculate multiplier and shift variable so that new data fits in specified range '''</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">                <tt class="py-name">fRange</tt> <tt class="py-op">=</tt> <tt class="py-name">fFeatMax</tt> <tt class="py-op">-</tt> <tt class="py-name">fFeatMin</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">                <tt class="py-name">fMult</tt> <tt class="py-op">=</tt> <tt class="py-name">fNewRange</tt> <tt class="py-op">/</tt> <tt class="py-name">fRange</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">                <tt class="py-name">fShift</tt> <tt class="py-op">=</tt> <tt class="py-name">fMin</tt> <tt class="py-op">-</tt> <tt class="py-op">(</tt><tt class="py-name">fFeatMin</tt> <tt class="py-op">*</tt> <tt class="py-name">fMult</tt><tt class="py-op">)</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">                 </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">                <tt class="py-string">''' scale and shift, save in return array '''</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line">                <tt class="py-name">naFeatures</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-51" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-51', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*=</tt> <tt class="py-name">fMult</tt> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">                <tt class="py-name">naFeatures</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-52" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-52', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">+=</tt> <tt class="py-name">fShift</tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">                <tt class="py-name">ltRet</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt> <tt class="py-op">(</tt><tt class="py-name">fMult</tt><tt class="py-op">,</tt> <tt class="py-name">fShift</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">         </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">ltRet</tt> </tt>
</div><a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line"> </tt>
<a name="normQuery"></a><div id="normQuery-def"><a name="L256"></a><tt class="py-lineno">256</tt> <a class="py-toggle" href="#" id="normQuery-toggle" onclick="return toggle('normQuery');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#normQuery">normQuery</a><tt class="py-op">(</tt> <tt class="py-param">naQueries</tt><tt class="py-op">,</tt> <tt class="py-param">ltWeightShift</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="normQuery-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="normQuery-expanded"><a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Normalizes the queries using the given normalization parameters generated from training data.</tt> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line"><tt class="py-docstring">        @param naQueries:  Numpy array of queries  </tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line"><tt class="py-docstring">        @param ltWeightShift: List of weights and shift amounts to be applied to each query.</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line"><tt class="py-docstring">        @return: None, modifies naQueries</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">         </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">        <tt class="py-keyword">assert</tt> <tt class="py-name">naQueries</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ltWeightShift</tt><tt class="py-op">)</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line">         </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-53" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-53', 'i', 'link-16');">i</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">naQueries</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">                 </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">                <tt class="py-string">''' scale and shift, save in return array '''</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">                <tt class="py-name">naQueries</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-54" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-54', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">*=</tt> <tt class="py-name">ltWeightShift</tt><tt class="py-op">[</tt><tt id="link-55" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-55', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">                <tt class="py-name">naQueries</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt id="link-56" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-56', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt> <tt class="py-op">+=</tt> <tt class="py-name">ltWeightShift</tt><tt class="py-op">[</tt><tt id="link-57" class="py-name"><a title="QSTK.Bin.gen_nyse_dates.i" class="py-name" href="#" onclick="return doclink('link-57', 'i', 'link-16');">i</a></tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> </tt>
</div><a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line">                 </tt>
<a name="createKnnLearner"></a><div id="createKnnLearner-def"><a name="L272"></a><tt class="py-lineno">272</tt> <a class="py-toggle" href="#" id="createKnnLearner-toggle" onclick="return toggle('createKnnLearner');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#createKnnLearner">createKnnLearner</a><tt class="py-op">(</tt> <tt class="py-param">naFeatures</tt><tt class="py-op">,</tt> <tt class="py-param">lKnn</tt><tt class="py-op">=</tt><tt class="py-number">30</tt><tt class="py-op">,</tt> <tt class="py-param">leafsize</tt><tt class="py-op">=</tt><tt class="py-number">10</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="createKnnLearner-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="createKnnLearner-expanded"><a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Creates a quick KNN learner </tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line"><tt class="py-docstring">        @param naFeatures:  Numpy array of features,  </tt> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line"><tt class="py-docstring">        @param fMin: Data frame containing the price information for all of the stocks.</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line"><tt class="py-docstring">        @param fMax: List of feature functions, most likely coming from features.py</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line"><tt class="py-docstring">        @param bAbsolute: If true, min value will be scaled to fMin, max to fMax, if false,</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line"><tt class="py-docstring">                                          +-1 standard deviations will be scaled to fit between fMin and fMax, i.e. ~69% of the values</tt> </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line"><tt class="py-docstring">        @param bIgnoreLast: If true, last column is ignored (assumed to be classification)</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line"><tt class="py-docstring">        @return: None, data is modified in place</tt> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt>      </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line">        <tt class="py-name">cLearner</tt> <tt class="py-op">=</tt> <tt class="py-name">kdt</tt><tt class="py-op">.</tt><tt id="link-58" class="py-name"><a title="QSTK.qstklearn.kdtknn
QSTK.qstklearn.kdtknn.kdtknn" class="py-name" href="#" onclick="return doclink('link-58', 'kdtknn', 'link-2');">kdtknn</a></tt><tt class="py-op">(</tt> <tt class="py-name">k</tt><tt class="py-op">=</tt><tt class="py-name">lKnn</tt><tt class="py-op">,</tt> <tt class="py-name">method</tt><tt class="py-op">=</tt><tt class="py-string">'mean'</tt><tt class="py-op">,</tt> <tt class="py-name">leafsize</tt><tt class="py-op">=</tt><tt class="py-name">leafsize</tt><tt class="py-op">)</tt> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line"> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">        <tt class="py-name">cLearner</tt><tt class="py-op">.</tt><tt id="link-59" class="py-name" targets="Method QSTK.qstklearn.fastknn.FastKNN.addEvidence()=QSTK.qstklearn.fastknn.FastKNN-class.html#addEvidence,Method QSTK.qstklearn.hmm.HMMLearner.addEvidence()=QSTK.qstklearn.hmm.HMMLearner-class.html#addEvidence,Method QSTK.qstklearn.kdtknn.kdtknn.addEvidence()=QSTK.qstklearn.kdtknn.kdtknn-class.html#addEvidence,Function QSTK.qstklearn.parallelknn.addEvidence()=QSTK.qstklearn.parallelknn-module.html#addEvidence"><a title="QSTK.qstklearn.fastknn.FastKNN.addEvidence
QSTK.qstklearn.hmm.HMMLearner.addEvidence
QSTK.qstklearn.kdtknn.kdtknn.addEvidence
QSTK.qstklearn.parallelknn.addEvidence" class="py-name" href="#" onclick="return doclink('link-59', 'addEvidence', 'link-59');">addEvidence</a></tt><tt class="py-op">(</tt> <tt class="py-name">naFeatures</tt> <tt class="py-op">)</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line"> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">cLearner</tt> </tt>
</div><a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line"> </tt>
<a name="log500"></a><div id="log500-def"><a name="L289"></a><tt class="py-lineno">289</tt> <a class="py-toggle" href="#" id="log500-toggle" onclick="return toggle('log500');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#log500">log500</a><tt class="py-op">(</tt> <tt class="py-param">sLog</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="log500-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="log500-expanded"><a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Loads cached features.</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line"><tt class="py-docstring">        @param sLog: Filename of features.</tt> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line"><tt class="py-docstring">        @return: Nothing, logs features to desired location</tt> </tt>
<a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">         </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line">         </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line">        <tt class="py-name">lsSym</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'A'</tt><tt class="py-op">,</tt> <tt class="py-string">'AA'</tt><tt class="py-op">,</tt> <tt class="py-string">'AAPL'</tt><tt class="py-op">,</tt> <tt class="py-string">'ABC'</tt><tt class="py-op">,</tt> <tt class="py-string">'ABT'</tt><tt class="py-op">,</tt> <tt class="py-string">'ACE'</tt><tt class="py-op">,</tt> <tt class="py-string">'ACN'</tt><tt class="py-op">,</tt> <tt class="py-string">'ADBE'</tt><tt class="py-op">,</tt> <tt class="py-string">'ADI'</tt><tt class="py-op">,</tt> <tt class="py-string">'ADM'</tt><tt class="py-op">,</tt> <tt class="py-string">'ADP'</tt><tt class="py-op">,</tt> <tt class="py-string">'ADSK'</tt><tt class="py-op">,</tt> <tt class="py-string">'AEE'</tt><tt class="py-op">,</tt> <tt class="py-string">'AEP'</tt><tt class="py-op">,</tt> <tt class="py-string">'AES'</tt><tt class="py-op">,</tt> <tt class="py-string">'AET'</tt><tt class="py-op">,</tt> <tt class="py-string">'AFL'</tt><tt class="py-op">,</tt> <tt class="py-string">'AGN'</tt><tt class="py-op">,</tt> <tt class="py-string">'AIG'</tt><tt class="py-op">,</tt> <tt class="py-string">'AIV'</tt><tt class="py-op">,</tt> <tt class="py-string">'AIZ'</tt><tt class="py-op">,</tt> <tt class="py-string">'AKAM'</tt><tt class="py-op">,</tt> <tt class="py-string">'AKS'</tt><tt class="py-op">,</tt> <tt class="py-string">'ALL'</tt><tt class="py-op">,</tt> <tt class="py-string">'ALTR'</tt><tt class="py-op">,</tt> <tt class="py-string">'AMAT'</tt><tt class="py-op">,</tt> <tt class="py-string">'AMD'</tt><tt class="py-op">,</tt> <tt class="py-string">'AMGN'</tt><tt class="py-op">,</tt> <tt class="py-string">'AMP'</tt><tt class="py-op">,</tt> <tt class="py-string">'AMT'</tt><tt class="py-op">,</tt> <tt class="py-string">'AMZN'</tt><tt class="py-op">,</tt> <tt class="py-string">'AN'</tt><tt class="py-op">,</tt> <tt class="py-string">'ANF'</tt><tt class="py-op">,</tt> <tt class="py-string">'ANR'</tt><tt class="py-op">,</tt> <tt class="py-string">'AON'</tt><tt class="py-op">,</tt> <tt class="py-string">'APA'</tt><tt class="py-op">,</tt> <tt class="py-string">'APC'</tt><tt class="py-op">,</tt> <tt class="py-string">'APD'</tt><tt class="py-op">,</tt> <tt class="py-string">'APH'</tt><tt class="py-op">,</tt> <tt class="py-string">'APOL'</tt><tt class="py-op">,</tt> <tt class="py-string">'ARG'</tt><tt class="py-op">,</tt> <tt class="py-string">'ATI'</tt><tt class="py-op">,</tt> <tt class="py-string">'AVB'</tt><tt class="py-op">,</tt> <tt class="py-string">'AVP'</tt><tt class="py-op">,</tt> <tt class="py-string">'AVY'</tt><tt class="py-op">,</tt> <tt class="py-string">'AXP'</tt><tt class="py-op">,</tt> <tt class="py-string">'AZO'</tt><tt class="py-op">,</tt> <tt class="py-string">'BA'</tt><tt class="py-op">,</tt> <tt class="py-string">'BAC'</tt><tt class="py-op">,</tt> <tt class="py-string">'BAX'</tt><tt class="py-op">,</tt> <tt class="py-string">'BBBY'</tt><tt class="py-op">,</tt> <tt class="py-string">'BBT'</tt><tt class="py-op">,</tt> <tt class="py-string">'BBY'</tt><tt class="py-op">,</tt> <tt class="py-string">'BCR'</tt><tt class="py-op">,</tt> <tt class="py-string">'BDX'</tt><tt class="py-op">,</tt> <tt class="py-string">'BEN'</tt><tt class="py-op">,</tt> <tt class="py-string">'BF.B'</tt><tt class="py-op">,</tt> <tt class="py-string">'BHI'</tt><tt class="py-op">,</tt> <tt class="py-string">'BIG'</tt><tt class="py-op">,</tt> <tt class="py-string">'BIIB'</tt><tt class="py-op">,</tt> <tt class="py-string">'BK'</tt><tt class="py-op">,</tt> <tt class="py-string">'BLK'</tt><tt class="py-op">,</tt> <tt class="py-string">'BLL'</tt><tt class="py-op">,</tt> <tt class="py-string">'BMC'</tt><tt class="py-op">,</tt> <tt class="py-string">'BMS'</tt><tt class="py-op">,</tt> <tt class="py-string">'BMY'</tt><tt class="py-op">,</tt> <tt class="py-string">'BRCM'</tt><tt class="py-op">,</tt> <tt class="py-string">'BRK.B'</tt><tt class="py-op">,</tt> <tt class="py-string">'BSX'</tt><tt class="py-op">,</tt> <tt class="py-string">'BTU'</tt><tt class="py-op">,</tt> <tt class="py-string">'BXP'</tt><tt class="py-op">,</tt> <tt class="py-string">'C'</tt><tt class="py-op">,</tt> <tt class="py-string">'CA'</tt><tt class="py-op">,</tt> <tt class="py-string">'CAG'</tt><tt class="py-op">,</tt> <tt class="py-string">'CAH'</tt><tt class="py-op">,</tt> <tt class="py-string">'CAM'</tt><tt class="py-op">,</tt> <tt class="py-string">'CAT'</tt><tt class="py-op">,</tt> <tt class="py-string">'CB'</tt><tt class="py-op">,</tt> <tt class="py-string">'CBG'</tt><tt class="py-op">,</tt> <tt class="py-string">'CBS'</tt><tt class="py-op">,</tt> <tt class="py-string">'CCE'</tt><tt class="py-op">,</tt> <tt class="py-string">'CCL'</tt><tt class="py-op">,</tt> <tt class="py-string">'CEG'</tt><tt class="py-op">,</tt> <tt class="py-string">'CELG'</tt><tt class="py-op">,</tt> <tt class="py-string">'CERN'</tt><tt class="py-op">,</tt> <tt class="py-string">'CF'</tt><tt class="py-op">,</tt> <tt class="py-string">'CFN'</tt><tt class="py-op">,</tt> <tt class="py-string">'CHK'</tt><tt class="py-op">,</tt> <tt class="py-string">'CHRW'</tt><tt class="py-op">,</tt> <tt class="py-string">'CI'</tt><tt class="py-op">,</tt> <tt class="py-string">'CINF'</tt><tt class="py-op">,</tt> <tt class="py-string">'CL'</tt><tt class="py-op">,</tt> <tt class="py-string">'CLF'</tt><tt class="py-op">,</tt> <tt class="py-string">'CLX'</tt><tt class="py-op">,</tt> <tt class="py-string">'CMA'</tt><tt class="py-op">,</tt> <tt class="py-string">'CMCSA'</tt><tt class="py-op">,</tt> <tt class="py-string">'CME'</tt><tt class="py-op">,</tt> <tt class="py-string">'CMG'</tt><tt class="py-op">,</tt> <tt class="py-string">'CMI'</tt><tt class="py-op">,</tt> <tt class="py-string">'CMS'</tt><tt class="py-op">,</tt> <tt class="py-string">'CNP'</tt><tt class="py-op">,</tt> <tt class="py-string">'CNX'</tt><tt class="py-op">,</tt> <tt class="py-string">'COF'</tt><tt class="py-op">,</tt> <tt class="py-string">'COG'</tt><tt class="py-op">,</tt> <tt class="py-string">'COH'</tt><tt class="py-op">,</tt> <tt class="py-string">'COL'</tt><tt class="py-op">,</tt> <tt class="py-string">'COP'</tt><tt class="py-op">,</tt> <tt class="py-string">'COST'</tt><tt class="py-op">,</tt> <tt class="py-string">'COV'</tt><tt class="py-op">,</tt> <tt class="py-string">'CPB'</tt><tt class="py-op">,</tt> <tt class="py-string">'CPWR'</tt><tt class="py-op">,</tt> <tt class="py-string">'CRM'</tt><tt class="py-op">,</tt> <tt class="py-string">'CSC'</tt><tt class="py-op">,</tt> <tt class="py-string">'CSCO'</tt><tt class="py-op">,</tt> <tt class="py-string">'CSX'</tt><tt class="py-op">,</tt> <tt class="py-string">'CTAS'</tt><tt class="py-op">,</tt> <tt class="py-string">'CTL'</tt><tt class="py-op">,</tt> <tt class="py-string">'CTSH'</tt><tt class="py-op">,</tt> <tt class="py-string">'CTXS'</tt><tt class="py-op">,</tt> <tt class="py-string">'CVC'</tt><tt class="py-op">,</tt> <tt class="py-string">'CVH'</tt><tt class="py-op">,</tt> <tt class="py-string">'CVS'</tt><tt class="py-op">,</tt> <tt class="py-string">'CVX'</tt><tt class="py-op">,</tt> <tt class="py-string">'D'</tt><tt class="py-op">,</tt> <tt class="py-string">'DD'</tt><tt class="py-op">,</tt> <tt class="py-string">'DE'</tt><tt class="py-op">,</tt> <tt class="py-string">'DELL'</tt><tt class="py-op">,</tt> <tt class="py-string">'DF'</tt><tt class="py-op">,</tt> <tt class="py-string">'DFS'</tt><tt class="py-op">,</tt> <tt class="py-string">'DGX'</tt><tt class="py-op">,</tt> <tt class="py-string">'DHI'</tt><tt class="py-op">,</tt> <tt class="py-string">'DHR'</tt><tt class="py-op">,</tt> <tt class="py-string">'DIS'</tt><tt class="py-op">,</tt> <tt class="py-string">'DISCA'</tt><tt class="py-op">,</tt> <tt class="py-string">'DNB'</tt><tt class="py-op">,</tt> <tt class="py-string">'DNR'</tt><tt class="py-op">,</tt> <tt class="py-string">'DO'</tt><tt class="py-op">,</tt> <tt class="py-string">'DOV'</tt><tt class="py-op">,</tt> <tt class="py-string">'DOW'</tt><tt class="py-op">,</tt> <tt class="py-string">'DPS'</tt><tt class="py-op">,</tt> <tt class="py-string">'DRI'</tt><tt class="py-op">,</tt> <tt class="py-string">'DTE'</tt><tt class="py-op">,</tt> <tt class="py-string">'DTV'</tt><tt class="py-op">,</tt> <tt class="py-string">'DUK'</tt><tt class="py-op">,</tt> <tt class="py-string">'DV'</tt><tt class="py-op">,</tt> <tt class="py-string">'DVA'</tt><tt class="py-op">,</tt> <tt class="py-string">'DVN'</tt><tt class="py-op">,</tt> <tt class="py-string">'EBAY'</tt><tt class="py-op">,</tt> <tt class="py-string">'ECL'</tt><tt class="py-op">,</tt> <tt class="py-string">'ED'</tt><tt class="py-op">,</tt> <tt class="py-string">'EFX'</tt><tt class="py-op">,</tt> <tt class="py-string">'EIX'</tt><tt class="py-op">,</tt> <tt class="py-string">'EL'</tt><tt class="py-op">,</tt> <tt class="py-string">'EMC'</tt><tt class="py-op">,</tt> <tt class="py-string">'EMN'</tt><tt class="py-op">,</tt> <tt class="py-string">'EMR'</tt><tt class="py-op">,</tt> <tt class="py-string">'EOG'</tt><tt class="py-op">,</tt> <tt class="py-string">'EP'</tt><tt class="py-op">,</tt> <tt class="py-string">'EQR'</tt><tt class="py-op">,</tt> <tt class="py-string">'EQT'</tt><tt class="py-op">,</tt> <tt class="py-string">'ERTS'</tt><tt class="py-op">,</tt> <tt class="py-string">'ESRX'</tt><tt class="py-op">,</tt> <tt class="py-string">'ETFC'</tt><tt class="py-op">,</tt> <tt class="py-string">'ETN'</tt><tt class="py-op">,</tt> <tt class="py-string">'ETR'</tt><tt class="py-op">,</tt> <tt class="py-string">'EW'</tt><tt class="py-op">,</tt> <tt class="py-string">'EXC'</tt><tt class="py-op">,</tt> <tt class="py-string">'EXPD'</tt><tt class="py-op">,</tt> <tt class="py-string">'EXPE'</tt><tt class="py-op">,</tt> <tt class="py-string">'F'</tt><tt class="py-op">,</tt> <tt class="py-string">'FAST'</tt><tt class="py-op">,</tt> <tt class="py-string">'FCX'</tt><tt class="py-op">,</tt> <tt class="py-string">'FDO'</tt><tt class="py-op">,</tt> <tt class="py-string">'FDX'</tt><tt class="py-op">,</tt> <tt class="py-string">'FE'</tt><tt class="py-op">,</tt> <tt class="py-string">'FFIV'</tt><tt class="py-op">,</tt> <tt class="py-string">'FHN'</tt><tt class="py-op">,</tt> <tt class="py-string">'FII'</tt><tt class="py-op">,</tt> <tt class="py-string">'FIS'</tt><tt class="py-op">,</tt> <tt class="py-string">'FISV'</tt><tt class="py-op">,</tt> <tt class="py-string">'FITB'</tt><tt class="py-op">,</tt> <tt class="py-string">'FLIR'</tt><tt class="py-op">,</tt> <tt class="py-string">'FLR'</tt><tt class="py-op">,</tt> <tt class="py-string">'FLS'</tt><tt class="py-op">,</tt> <tt class="py-string">'FMC'</tt><tt class="py-op">,</tt> <tt class="py-string">'FO'</tt><tt class="py-op">,</tt> <tt class="py-string">'FRX'</tt><tt class="py-op">,</tt> <tt class="py-string">'FSLR'</tt><tt class="py-op">,</tt> <tt class="py-string">'FTI'</tt><tt class="py-op">,</tt> <tt class="py-string">'FTR'</tt><tt class="py-op">,</tt> <tt class="py-string">'GAS'</tt><tt class="py-op">,</tt> <tt class="py-string">'GCI'</tt><tt class="py-op">,</tt> <tt class="py-string">'GD'</tt><tt class="py-op">,</tt> <tt class="py-string">'GE'</tt><tt class="py-op">,</tt> <tt class="py-string">'GILD'</tt><tt class="py-op">,</tt> <tt class="py-string">'GIS'</tt><tt class="py-op">,</tt> <tt class="py-string">'GLW'</tt><tt class="py-op">,</tt> <tt class="py-string">'GME'</tt><tt class="py-op">,</tt> <tt class="py-string">'GNW'</tt><tt class="py-op">,</tt> <tt class="py-string">'GOOG'</tt><tt class="py-op">,</tt> <tt class="py-string">'GPC'</tt><tt class="py-op">,</tt> <tt class="py-string">'GPS'</tt><tt class="py-op">,</tt> <tt class="py-string">'GR'</tt><tt class="py-op">,</tt> <tt class="py-string">'GS'</tt><tt class="py-op">,</tt> <tt class="py-string">'GT'</tt><tt class="py-op">,</tt> <tt class="py-string">'GWW'</tt><tt class="py-op">,</tt> <tt class="py-string">'HAL'</tt><tt class="py-op">,</tt> <tt class="py-string">'HAR'</tt><tt class="py-op">,</tt> <tt class="py-string">'HAS'</tt><tt class="py-op">,</tt> <tt class="py-string">'HBAN'</tt><tt class="py-op">,</tt> <tt class="py-string">'HCBK'</tt><tt class="py-op">,</tt> <tt class="py-string">'HCN'</tt><tt class="py-op">,</tt> <tt class="py-string">'HCP'</tt><tt class="py-op">,</tt> <tt class="py-string">'HD'</tt><tt class="py-op">,</tt> <tt class="py-string">'HES'</tt><tt class="py-op">,</tt> <tt class="py-string">'HIG'</tt><tt class="py-op">,</tt> <tt class="py-string">'HNZ'</tt><tt class="py-op">,</tt> <tt class="py-string">'HOG'</tt><tt class="py-op">,</tt> <tt class="py-string">'HON'</tt><tt class="py-op">,</tt> <tt class="py-string">'HOT'</tt><tt class="py-op">,</tt> <tt class="py-string">'HP'</tt><tt class="py-op">,</tt> <tt class="py-string">'HPQ'</tt><tt class="py-op">,</tt> <tt class="py-string">'HRB'</tt><tt class="py-op">,</tt> <tt class="py-string">'HRL'</tt><tt class="py-op">,</tt> <tt class="py-string">'HRS'</tt><tt class="py-op">,</tt> <tt class="py-string">'HSP'</tt><tt class="py-op">,</tt> <tt class="py-string">'HST'</tt><tt class="py-op">,</tt> <tt class="py-string">'HSY'</tt><tt class="py-op">,</tt> <tt class="py-string">'HUM'</tt><tt class="py-op">,</tt> <tt class="py-string">'IBM'</tt><tt class="py-op">,</tt> <tt class="py-string">'ICE'</tt><tt class="py-op">,</tt> <tt class="py-string">'IFF'</tt><tt class="py-op">,</tt> <tt class="py-string">'IGT'</tt><tt class="py-op">,</tt> <tt class="py-string">'INTC'</tt><tt class="py-op">,</tt> <tt class="py-string">'INTU'</tt><tt class="py-op">,</tt> <tt class="py-string">'IP'</tt><tt class="py-op">,</tt> <tt class="py-string">'IPG'</tt><tt class="py-op">,</tt> <tt class="py-string">'IR'</tt><tt class="py-op">,</tt> <tt class="py-string">'IRM'</tt><tt class="py-op">,</tt> <tt class="py-string">'ISRG'</tt><tt class="py-op">,</tt> <tt class="py-string">'ITT'</tt><tt class="py-op">,</tt> <tt class="py-string">'ITW'</tt><tt class="py-op">,</tt> <tt class="py-string">'IVZ'</tt><tt class="py-op">,</tt> <tt class="py-string">'JBL'</tt><tt class="py-op">,</tt> <tt class="py-string">'JCI'</tt><tt class="py-op">,</tt> <tt class="py-string">'JCP'</tt><tt class="py-op">,</tt> <tt class="py-string">'JDSU'</tt><tt class="py-op">,</tt> <tt class="py-string">'JEC'</tt><tt class="py-op">,</tt> <tt class="py-string">'JNJ'</tt><tt class="py-op">,</tt> <tt class="py-string">'JNPR'</tt><tt class="py-op">,</tt> <tt class="py-string">'JNS'</tt><tt class="py-op">,</tt> <tt class="py-string">'JOYG'</tt><tt class="py-op">,</tt> <tt class="py-string">'JPM'</tt><tt class="py-op">,</tt> <tt class="py-string">'JWN'</tt><tt class="py-op">,</tt> <tt class="py-string">'K'</tt><tt class="py-op">,</tt> <tt class="py-string">'KEY'</tt><tt class="py-op">,</tt> <tt class="py-string">'KFT'</tt><tt class="py-op">,</tt> <tt class="py-string">'KIM'</tt><tt class="py-op">,</tt> <tt class="py-string">'KLAC'</tt><tt class="py-op">,</tt> <tt class="py-string">'KMB'</tt><tt class="py-op">,</tt> <tt class="py-string">'KMX'</tt><tt class="py-op">,</tt> <tt class="py-string">'KO'</tt><tt class="py-op">,</tt> <tt class="py-string">'KR'</tt><tt class="py-op">,</tt> <tt class="py-string">'KSS'</tt><tt class="py-op">,</tt> <tt class="py-string">'L'</tt><tt class="py-op">,</tt> <tt class="py-string">'LEG'</tt><tt class="py-op">,</tt> <tt class="py-string">'LEN'</tt><tt class="py-op">,</tt> <tt class="py-string">'LH'</tt><tt class="py-op">,</tt> <tt class="py-string">'LIFE'</tt><tt class="py-op">,</tt> <tt class="py-string">'LLL'</tt><tt class="py-op">,</tt> <tt class="py-string">'LLTC'</tt><tt class="py-op">,</tt> <tt class="py-string">'LLY'</tt><tt class="py-op">,</tt> <tt class="py-string">'LM'</tt><tt class="py-op">,</tt> <tt class="py-string">'LMT'</tt><tt class="py-op">,</tt> <tt class="py-string">'LNC'</tt><tt class="py-op">,</tt> <tt class="py-string">'LO'</tt><tt class="py-op">,</tt> <tt class="py-string">'LOW'</tt><tt class="py-op">,</tt> <tt class="py-string">'LSI'</tt><tt class="py-op">,</tt> <tt class="py-string">'LTD'</tt><tt class="py-op">,</tt> <tt class="py-string">'LUK'</tt><tt class="py-op">,</tt> <tt class="py-string">'LUV'</tt><tt class="py-op">,</tt> <tt class="py-string">'LXK'</tt><tt class="py-op">,</tt> <tt class="py-string">'M'</tt><tt class="py-op">,</tt> <tt class="py-string">'MA'</tt><tt class="py-op">,</tt> <tt class="py-string">'MAR'</tt><tt class="py-op">,</tt> <tt class="py-string">'MAS'</tt><tt class="py-op">,</tt> <tt class="py-string">'MAT'</tt><tt class="py-op">,</tt> <tt class="py-string">'MCD'</tt><tt class="py-op">,</tt> <tt class="py-string">'MCHP'</tt><tt class="py-op">,</tt> <tt class="py-string">'MCK'</tt><tt class="py-op">,</tt> <tt class="py-string">'MCO'</tt><tt class="py-op">,</tt> <tt class="py-string">'MDT'</tt><tt class="py-op">,</tt> <tt class="py-string">'MET'</tt><tt class="py-op">,</tt> <tt class="py-string">'MHP'</tt><tt class="py-op">,</tt> <tt class="py-string">'MHS'</tt><tt class="py-op">,</tt> <tt class="py-string">'MJN'</tt><tt class="py-op">,</tt> <tt class="py-string">'MKC'</tt><tt class="py-op">,</tt> <tt class="py-string">'MMC'</tt><tt class="py-op">,</tt> <tt class="py-string">'MMI'</tt><tt class="py-op">,</tt> <tt class="py-string">'MMM'</tt><tt class="py-op">,</tt> <tt class="py-string">'MO'</tt><tt class="py-op">,</tt> <tt class="py-string">'MOLX'</tt><tt class="py-op">,</tt> <tt class="py-string">'MON'</tt><tt class="py-op">,</tt> <tt class="py-string">'MOS'</tt><tt class="py-op">,</tt> <tt class="py-string">'MPC'</tt><tt class="py-op">,</tt> <tt class="py-string">'MRK'</tt><tt class="py-op">,</tt> <tt class="py-string">'MRO'</tt><tt class="py-op">,</tt> <tt class="py-string">'MS'</tt><tt class="py-op">,</tt> <tt class="py-string">'MSFT'</tt><tt class="py-op">,</tt> <tt class="py-string">'MSI'</tt><tt class="py-op">,</tt> <tt class="py-string">'MTB'</tt><tt class="py-op">,</tt> <tt class="py-string">'MU'</tt><tt class="py-op">,</tt> <tt class="py-string">'MUR'</tt><tt class="py-op">,</tt> <tt class="py-string">'MWV'</tt><tt class="py-op">,</tt> <tt class="py-string">'MWW'</tt><tt class="py-op">,</tt> <tt class="py-string">'MYL'</tt><tt class="py-op">,</tt> <tt class="py-string">'NBL'</tt><tt class="py-op">,</tt> <tt class="py-string">'NBR'</tt><tt class="py-op">,</tt> <tt class="py-string">'NDAQ'</tt><tt class="py-op">,</tt> <tt class="py-string">'NE'</tt><tt class="py-op">,</tt> <tt class="py-string">'NEE'</tt><tt class="py-op">,</tt> <tt class="py-string">'NEM'</tt><tt class="py-op">,</tt> <tt class="py-string">'NFLX'</tt><tt class="py-op">,</tt> <tt class="py-string">'NFX'</tt><tt class="py-op">,</tt> <tt class="py-string">'NI'</tt><tt class="py-op">,</tt> <tt class="py-string">'NKE'</tt><tt class="py-op">,</tt> <tt class="py-string">'NOC'</tt><tt class="py-op">,</tt> <tt class="py-string">'NOV'</tt><tt class="py-op">,</tt> <tt class="py-string">'NRG'</tt><tt class="py-op">,</tt> <tt class="py-string">'NSC'</tt><tt class="py-op">,</tt> <tt class="py-string">'NTAP'</tt><tt class="py-op">,</tt> <tt class="py-string">'NTRS'</tt><tt class="py-op">,</tt> <tt class="py-string">'NU'</tt><tt class="py-op">,</tt> <tt class="py-string">'NUE'</tt><tt class="py-op">,</tt> <tt class="py-string">'NVDA'</tt><tt class="py-op">,</tt> <tt class="py-string">'NVLS'</tt><tt class="py-op">,</tt> <tt class="py-string">'NWL'</tt><tt class="py-op">,</tt> <tt class="py-string">'NWSA'</tt><tt class="py-op">,</tt> <tt class="py-string">'NYX'</tt><tt class="py-op">,</tt> <tt class="py-string">'OI'</tt><tt class="py-op">,</tt> <tt class="py-string">'OKE'</tt><tt class="py-op">,</tt> <tt class="py-string">'OMC'</tt><tt class="py-op">,</tt> <tt class="py-string">'ORCL'</tt><tt class="py-op">,</tt> <tt class="py-string">'ORLY'</tt><tt class="py-op">,</tt> <tt class="py-string">'OXY'</tt><tt class="py-op">,</tt> <tt class="py-string">'PAYX'</tt><tt class="py-op">,</tt> <tt class="py-string">'PBCT'</tt><tt class="py-op">,</tt> <tt class="py-string">'PBI'</tt><tt class="py-op">,</tt> <tt class="py-string">'PCAR'</tt><tt class="py-op">,</tt> <tt class="py-string">'PCG'</tt><tt class="py-op">,</tt> <tt class="py-string">'PCL'</tt><tt class="py-op">,</tt> <tt class="py-string">'PCLN'</tt><tt class="py-op">,</tt> <tt class="py-string">'PCP'</tt><tt class="py-op">,</tt> <tt class="py-string">'PCS'</tt><tt class="py-op">,</tt> <tt class="py-string">'PDCO'</tt><tt class="py-op">,</tt> <tt class="py-string">'PEG'</tt><tt class="py-op">,</tt> <tt class="py-string">'PEP'</tt><tt class="py-op">,</tt> <tt class="py-string">'PFE'</tt><tt class="py-op">,</tt> <tt class="py-string">'PFG'</tt><tt class="py-op">,</tt> <tt class="py-string">'PG'</tt><tt class="py-op">,</tt> <tt class="py-string">'PGN'</tt><tt class="py-op">,</tt> <tt class="py-string">'PGR'</tt><tt class="py-op">,</tt> <tt class="py-string">'PH'</tt><tt class="py-op">,</tt> <tt class="py-string">'PHM'</tt><tt class="py-op">,</tt> <tt class="py-string">'PKI'</tt><tt class="py-op">,</tt> <tt class="py-string">'PLD'</tt><tt class="py-op">,</tt> <tt class="py-string">'PLL'</tt><tt class="py-op">,</tt> <tt class="py-string">'PM'</tt><tt class="py-op">,</tt> <tt class="py-string">'PNC'</tt><tt class="py-op">,</tt> <tt class="py-string">'PNW'</tt><tt class="py-op">,</tt> <tt class="py-string">'POM'</tt><tt class="py-op">,</tt> <tt class="py-string">'PPG'</tt><tt class="py-op">,</tt> <tt class="py-string">'PPL'</tt><tt class="py-op">,</tt> <tt class="py-string">'PRU'</tt><tt class="py-op">,</tt> <tt class="py-string">'PSA'</tt><tt class="py-op">,</tt> <tt class="py-string">'PWR'</tt><tt class="py-op">,</tt> <tt class="py-string">'PX'</tt><tt class="py-op">,</tt> <tt class="py-string">'PXD'</tt><tt class="py-op">,</tt> <tt class="py-string">'QCOM'</tt><tt class="py-op">,</tt> <tt class="py-string">'QEP'</tt><tt class="py-op">,</tt> <tt class="py-string">'R'</tt><tt class="py-op">,</tt> <tt class="py-string">'RAI'</tt><tt class="py-op">,</tt> <tt class="py-string">'RDC'</tt><tt class="py-op">,</tt> <tt class="py-string">'RF'</tt><tt class="py-op">,</tt> <tt class="py-string">'RHI'</tt><tt class="py-op">,</tt> <tt class="py-string">'RHT'</tt><tt class="py-op">,</tt> <tt class="py-string">'RL'</tt><tt class="py-op">,</tt> <tt class="py-string">'ROK'</tt><tt class="py-op">,</tt> <tt class="py-string">'ROP'</tt><tt class="py-op">,</tt> <tt class="py-string">'ROST'</tt><tt class="py-op">,</tt> <tt class="py-string">'RRC'</tt><tt class="py-op">,</tt> <tt class="py-string">'RRD'</tt><tt class="py-op">,</tt> <tt class="py-string">'RSG'</tt><tt class="py-op">,</tt> <tt class="py-string">'RTN'</tt><tt class="py-op">,</tt> <tt class="py-string">'S'</tt><tt class="py-op">,</tt> <tt class="py-string">'SAI'</tt><tt class="py-op">,</tt> <tt class="py-string">'SBUX'</tt><tt class="py-op">,</tt> <tt class="py-string">'SCG'</tt><tt class="py-op">,</tt> <tt class="py-string">'SCHW'</tt><tt class="py-op">,</tt> <tt class="py-string">'SE'</tt><tt class="py-op">,</tt> <tt class="py-string">'SEE'</tt><tt class="py-op">,</tt> <tt class="py-string">'SHLD'</tt><tt class="py-op">,</tt> <tt class="py-string">'SHW'</tt><tt class="py-op">,</tt> <tt class="py-string">'SIAL'</tt><tt class="py-op">,</tt> <tt class="py-string">'SJM'</tt><tt class="py-op">,</tt> <tt class="py-string">'SLB'</tt><tt class="py-op">,</tt> <tt class="py-string">'SLE'</tt><tt class="py-op">,</tt> <tt class="py-string">'SLM'</tt><tt class="py-op">,</tt> <tt class="py-string">'SNA'</tt><tt class="py-op">,</tt> <tt class="py-string">'SNDK'</tt><tt class="py-op">,</tt> <tt class="py-string">'SNI'</tt><tt class="py-op">,</tt> <tt class="py-string">'SO'</tt><tt class="py-op">,</tt> <tt class="py-string">'SPG'</tt><tt class="py-op">,</tt> <tt class="py-string">'SPLS'</tt><tt class="py-op">,</tt> <tt class="py-string">'SRCL'</tt><tt class="py-op">,</tt> <tt class="py-string">'SRE'</tt><tt class="py-op">,</tt> <tt class="py-string">'STI'</tt><tt class="py-op">,</tt> <tt class="py-string">'STJ'</tt><tt class="py-op">,</tt> <tt class="py-string">'STT'</tt><tt class="py-op">,</tt> <tt class="py-string">'STZ'</tt><tt class="py-op">,</tt> <tt class="py-string">'SUN'</tt><tt class="py-op">,</tt> <tt class="py-string">'SVU'</tt><tt class="py-op">,</tt> <tt class="py-string">'SWK'</tt><tt class="py-op">,</tt> <tt class="py-string">'SWN'</tt><tt class="py-op">,</tt> <tt class="py-string">'SWY'</tt><tt class="py-op">,</tt> <tt class="py-string">'SYK'</tt><tt class="py-op">,</tt> <tt class="py-string">'SYMC'</tt><tt class="py-op">,</tt> <tt class="py-string">'SYY'</tt><tt class="py-op">,</tt> <tt class="py-string">'T'</tt><tt class="py-op">,</tt> <tt class="py-string">'TAP'</tt><tt class="py-op">,</tt> <tt class="py-string">'TDC'</tt><tt class="py-op">,</tt> <tt class="py-string">'TE'</tt><tt class="py-op">,</tt> <tt class="py-string">'TEG'</tt><tt class="py-op">,</tt> <tt class="py-string">'TEL'</tt><tt class="py-op">,</tt> <tt class="py-string">'TER'</tt><tt class="py-op">,</tt> <tt class="py-string">'TGT'</tt><tt class="py-op">,</tt> <tt class="py-string">'THC'</tt><tt class="py-op">,</tt> <tt class="py-string">'TIE'</tt><tt class="py-op">,</tt> <tt class="py-string">'TIF'</tt><tt class="py-op">,</tt> <tt class="py-string">'TJX'</tt><tt class="py-op">,</tt> <tt class="py-string">'TLAB'</tt><tt class="py-op">,</tt> <tt class="py-string">'TMK'</tt><tt class="py-op">,</tt> <tt class="py-string">'TMO'</tt><tt class="py-op">,</tt> <tt class="py-string">'TROW'</tt><tt class="py-op">,</tt> <tt class="py-string">'TRV'</tt><tt class="py-op">,</tt> <tt class="py-string">'TSN'</tt><tt class="py-op">,</tt> <tt class="py-string">'TSO'</tt><tt class="py-op">,</tt> <tt class="py-string">'TSS'</tt><tt class="py-op">,</tt> <tt class="py-string">'TWC'</tt><tt class="py-op">,</tt> <tt class="py-string">'TWX'</tt><tt class="py-op">,</tt> <tt class="py-string">'TXN'</tt><tt class="py-op">,</tt> <tt class="py-string">'TXT'</tt><tt class="py-op">,</tt> <tt class="py-string">'TYC'</tt><tt class="py-op">,</tt> <tt class="py-string">'UNH'</tt><tt class="py-op">,</tt> <tt class="py-string">'UNM'</tt><tt class="py-op">,</tt> <tt class="py-string">'UNP'</tt><tt class="py-op">,</tt> <tt class="py-string">'UPS'</tt><tt class="py-op">,</tt> <tt class="py-string">'URBN'</tt><tt class="py-op">,</tt> <tt class="py-string">'USB'</tt><tt class="py-op">,</tt> <tt class="py-string">'UTX'</tt><tt class="py-op">,</tt> <tt class="py-string">'V'</tt><tt class="py-op">,</tt> <tt class="py-string">'VAR'</tt><tt class="py-op">,</tt> <tt class="py-string">'VFC'</tt><tt class="py-op">,</tt> <tt class="py-string">'VIA.B'</tt><tt class="py-op">,</tt> <tt class="py-string">'VLO'</tt><tt class="py-op">,</tt> <tt class="py-string">'VMC'</tt><tt class="py-op">,</tt> <tt class="py-string">'VNO'</tt><tt class="py-op">,</tt> <tt class="py-string">'VRSN'</tt><tt class="py-op">,</tt> <tt class="py-string">'VTR'</tt><tt class="py-op">,</tt> <tt class="py-string">'VZ'</tt><tt class="py-op">,</tt> <tt class="py-string">'WAG'</tt><tt class="py-op">,</tt> <tt class="py-string">'WAT'</tt><tt class="py-op">,</tt> <tt class="py-string">'WDC'</tt><tt class="py-op">,</tt> <tt class="py-string">'WEC'</tt><tt class="py-op">,</tt> <tt class="py-string">'WFC'</tt><tt class="py-op">,</tt> <tt class="py-string">'WFM'</tt><tt class="py-op">,</tt> <tt class="py-string">'WFR'</tt><tt class="py-op">,</tt> <tt class="py-string">'WHR'</tt><tt class="py-op">,</tt> <tt class="py-string">'WIN'</tt><tt class="py-op">,</tt> <tt class="py-string">'WLP'</tt><tt class="py-op">,</tt> <tt class="py-string">'WM'</tt><tt class="py-op">,</tt> <tt class="py-string">'WMB'</tt><tt class="py-op">,</tt> <tt class="py-string">'WMT'</tt><tt class="py-op">,</tt> <tt class="py-string">'WPI'</tt><tt class="py-op">,</tt> <tt class="py-string">'WPO'</tt><tt class="py-op">,</tt> <tt class="py-string">'WU'</tt><tt class="py-op">,</tt> <tt class="py-string">'WY'</tt><tt class="py-op">,</tt> <tt class="py-string">'WYN'</tt><tt class="py-op">,</tt> <tt class="py-string">'WYNN'</tt><tt class="py-op">,</tt> <tt class="py-string">'X'</tt><tt class="py-op">,</tt> <tt class="py-string">'XEL'</tt><tt class="py-op">,</tt> <tt class="py-string">'XL'</tt><tt class="py-op">,</tt> <tt class="py-string">'XLNX'</tt><tt class="py-op">,</tt> <tt class="py-string">'XOM'</tt><tt class="py-op">,</tt> <tt class="py-string">'XRAY'</tt><tt class="py-op">,</tt> <tt class="py-string">'XRX'</tt><tt class="py-op">,</tt> <tt class="py-string">'YHOO'</tt><tt class="py-op">,</tt> <tt class="py-string">'YUM'</tt><tt class="py-op">,</tt> <tt class="py-string">'ZION'</tt><tt class="py-op">,</tt> <tt class="py-string">'ZMH'</tt><tt class="py-op">]</tt> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">        <tt class="py-name">lsSym</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-string">'$SPX'</tt><tt class="py-op">)</tt> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">        <tt class="py-name">lsSym</tt><tt class="py-op">.</tt><tt class="py-name">sort</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">         </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line">         </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">        <tt class="py-string">''' Max lookback is 6 months '''</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line">        <tt class="py-name">dtEnd</tt> <tt class="py-op">=</tt> <tt class="py-name">dt</tt><tt class="py-op">.</tt><tt class="py-name">datetime</tt><tt class="py-op">.</tt><tt class="py-name">now</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line">        <tt class="py-name">dtEnd</tt> <tt class="py-op">=</tt> <tt class="py-name">dtEnd</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-name">hour</tt><tt class="py-op">=</tt><tt class="py-number">16</tt><tt class="py-op">,</tt> <tt class="py-name">minute</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-name">second</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-name">microsecond</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">        <tt class="py-name">dtStart</tt> <tt class="py-op">=</tt> <tt class="py-name">dtEnd</tt> <tt class="py-op">-</tt> <tt class="py-name">relativedelta</tt><tt class="py-op">(</tt><tt class="py-name">months</tt><tt class="py-op">=</tt><tt class="py-number">6</tt><tt class="py-op">)</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line">         </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">         </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line">        <tt class="py-string">''' Pull in current data '''</tt> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">        <tt class="py-name">norObj</tt> <tt class="py-op">=</tt> <tt class="py-name">da</tt><tt class="py-op">.</tt><tt id="link-60" class="py-name"><a title="QSTK.qstkutil.DataAccess
QSTK.qstkutil.DataAccess.DataAccess" class="py-name" href="#" onclick="return doclink('link-60', 'DataAccess', 'link-4');">DataAccess</a></tt><tt class="py-op">(</tt><tt class="py-string">'Norgate'</tt><tt class="py-op">)</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line">        <tt class="py-string">''' Get 2 extra months for moving averages and future returns '''</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line">        <tt class="py-name">ldtTimestamps</tt> <tt class="py-op">=</tt> <tt class="py-name">du</tt><tt class="py-op">.</tt><tt id="link-61" class="py-name" targets="Function QSTK.qstkutil.dateutil.getNYSEdays()=QSTK.qstkutil.dateutil-module.html#getNYSEdays"><a title="QSTK.qstkutil.dateutil.getNYSEdays" class="py-name" href="#" onclick="return doclink('link-61', 'getNYSEdays', 'link-61');">getNYSEdays</a></tt><tt class="py-op">(</tt> <tt class="py-name">dtStart</tt> <tt class="py-op">-</tt> <tt class="py-name">relativedelta</tt><tt class="py-op">(</tt><tt class="py-name">months</tt><tt class="py-op">=</tt><tt class="py-number">2</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> \ </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">                                                                        <tt class="py-name">dtEnd</tt>   <tt class="py-op">+</tt> <tt class="py-name">relativedelta</tt><tt class="py-op">(</tt><tt class="py-name">months</tt><tt class="py-op">=</tt><tt class="py-number">2</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">dt</tt><tt class="py-op">.</tt><tt class="py-name">timedelta</tt><tt class="py-op">(</tt><tt class="py-name">hours</tt><tt class="py-op">=</tt><tt class="py-number">16</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line">         </tt>
<a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line">        <tt class="py-name">dfPrice</tt> <tt class="py-op">=</tt> <tt class="py-name">norObj</tt><tt class="py-op">.</tt><tt id="link-62" class="py-name" targets="Method QSTK.qstkutil.DataAccess.DataAccess.get_data()=QSTK.qstkutil.DataAccess.DataAccess-class.html#get_data"><a title="QSTK.qstkutil.DataAccess.DataAccess.get_data" class="py-name" href="#" onclick="return doclink('link-62', 'get_data', 'link-62');">get_data</a></tt><tt class="py-op">(</tt> <tt class="py-name">ldtTimestamps</tt><tt class="py-op">,</tt> <tt class="py-name">lsSym</tt><tt class="py-op">,</tt> <tt class="py-string">'close'</tt> <tt class="py-op">)</tt> </tt>
<a name="L315"></a><tt class="py-lineno">315</tt>  <tt class="py-line">        <tt class="py-name">dfVolume</tt> <tt class="py-op">=</tt> <tt class="py-name">norObj</tt><tt class="py-op">.</tt><tt id="link-63" class="py-name"><a title="QSTK.qstkutil.DataAccess.DataAccess.get_data" class="py-name" href="#" onclick="return doclink('link-63', 'get_data', 'link-62');">get_data</a></tt><tt class="py-op">(</tt> <tt class="py-name">ldtTimestamps</tt><tt class="py-op">,</tt> <tt class="py-name">lsSym</tt><tt class="py-op">,</tt> <tt class="py-string">'volume'</tt> <tt class="py-op">)</tt> </tt>
<a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line"> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line">        <tt class="py-string">''' Imported functions from qstkfeat.features, NOTE: last function is classification '''</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line">        <tt class="py-name">lfcFeatures</tt><tt class="py-op">,</tt> <tt class="py-name">ldArgs</tt><tt class="py-op">,</tt> <tt class="py-name">lsNames</tt> <tt class="py-op">=</tt> <tt id="link-64" class="py-name" targets="Function QSTK.qstkfeat.featutil.getFeatureFuncs()=QSTK.qstkfeat.featutil-module.html#getFeatureFuncs"><a title="QSTK.qstkfeat.featutil.getFeatureFuncs" class="py-name" href="#" onclick="return doclink('link-64', 'getFeatureFuncs', 'link-64');">getFeatureFuncs</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt>                                 </tt>
<a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line">         </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line">        <tt class="py-string">''' Generate a list of DataFrames, one for each feature, with the same index/column structure as price data '''</tt> </tt>
<a name="L321"></a><tt class="py-lineno">321</tt>  <tt class="py-line">        <tt id="link-65" class="py-name" targets="Function QSTK.qstkfeat.featutil.applyFeatures()=QSTK.qstkfeat.featutil-module.html#applyFeatures"><a title="QSTK.qstkfeat.featutil.applyFeatures" class="py-name" href="#" onclick="return doclink('link-65', 'applyFeatures', 'link-65');">applyFeatures</a></tt><tt class="py-op">(</tt> <tt class="py-name">dfPrice</tt><tt class="py-op">,</tt> <tt class="py-name">dfVolume</tt><tt class="py-op">,</tt> <tt class="py-name">lfcFeatures</tt><tt class="py-op">,</tt> <tt class="py-name">ldArgs</tt><tt class="py-op">,</tt> <tt class="py-name">sLog</tt><tt class="py-op">=</tt><tt class="py-name">sLog</tt> <tt class="py-op">)</tt> </tt>
</div><a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line"> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line"> </tt>
<a name="getFeatureFuncs"></a><div id="getFeatureFuncs-def"><a name="L324"></a><tt class="py-lineno">324</tt> <a class="py-toggle" href="#" id="getFeatureFuncs-toggle" onclick="return toggle('getFeatureFuncs');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#getFeatureFuncs">getFeatureFuncs</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="getFeatureFuncs-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="getFeatureFuncs-expanded"><a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Gets feature functions supported by the website.</tt> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line"><tt class="py-docstring">        @return: Tuple containing (list of functions, list of arguments, list of names)</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line">         </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line">        <tt class="py-name">lfcFeatures</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> <tt id="link-66" class="py-name" targets="Function QSTK.qstkfeat.features.featMA()=QSTK.qstkfeat.features-module.html#featMA"><a title="QSTK.qstkfeat.features.featMA" class="py-name" href="#" onclick="return doclink('link-66', 'featMA', 'link-66');">featMA</a></tt><tt class="py-op">,</tt> <tt id="link-67" class="py-name"><a title="QSTK.qstkfeat.features.featMA" class="py-name" href="#" onclick="return doclink('link-67', 'featMA', 'link-66');">featMA</a></tt><tt class="py-op">,</tt> <tt id="link-68" class="py-name" targets="Function QSTK.qstkfeat.features.featRSI()=QSTK.qstkfeat.features-module.html#featRSI"><a title="QSTK.qstkfeat.features.featRSI" class="py-name" href="#" onclick="return doclink('link-68', 'featRSI', 'link-68');">featRSI</a></tt><tt class="py-op">,</tt> <tt id="link-69" class="py-name" targets="Function QSTK.qstkfeat.features.featDrawDown()=QSTK.qstkfeat.features-module.html#featDrawDown"><a title="QSTK.qstkfeat.features.featDrawDown" class="py-name" href="#" onclick="return doclink('link-69', 'featDrawDown', 'link-69');">featDrawDown</a></tt><tt class="py-op">,</tt> <tt id="link-70" class="py-name" targets="Function QSTK.qstkfeat.features.featRunUp()=QSTK.qstkfeat.features-module.html#featRunUp"><a title="QSTK.qstkfeat.features.featRunUp" class="py-name" href="#" onclick="return doclink('link-70', 'featRunUp', 'link-70');">featRunUp</a></tt><tt class="py-op">,</tt> <tt id="link-71" class="py-name" targets="Function QSTK.qstkfeat.features.featVolumeDelta()=QSTK.qstkfeat.features-module.html#featVolumeDelta"><a title="QSTK.qstkfeat.features.featVolumeDelta" class="py-name" href="#" onclick="return doclink('link-71', 'featVolumeDelta', 'link-71');">featVolumeDelta</a></tt><tt class="py-op">,</tt> <tt id="link-72" class="py-name"><a title="QSTK.qstkfeat.classes.classFutRet" class="py-name" href="#" onclick="return doclink('link-72', 'classFutRet', 'link-13');">classFutRet</a></tt> <tt class="py-op">]</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line">        <tt class="py-name">lsNames</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'Moving Average'</tt><tt class="py-op">,</tt> <tt class="py-string">'Relative Moving Average'</tt><tt class="py-op">,</tt> <tt class="py-string">'RSI'</tt><tt class="py-op">,</tt> <tt class="py-string">'Draw Down'</tt><tt class="py-op">,</tt> <tt class="py-string">'Run Up'</tt><tt class="py-op">,</tt> <tt class="py-string">'Volume Delta'</tt><tt class="py-op">,</tt> <tt class="py-string">'Future Returns'</tt><tt class="py-op">]</tt> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line">           </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line">        <tt class="py-string">''' Custom Arguments '''</tt> </tt>
<a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line">        <tt class="py-name">ldArgs</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> <tt class="py-op">{</tt><tt class="py-string">'lLookback'</tt><tt class="py-op">:</tt><tt class="py-number">30</tt><tt class="py-op">}</tt><tt class="py-op">,</tt>\ </tt>
<a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line">                           <tt class="py-op">{</tt><tt class="py-string">'lLookback'</tt><tt class="py-op">:</tt><tt class="py-number">30</tt><tt class="py-op">,</tt> <tt class="py-string">'bRel'</tt><tt class="py-op">:</tt><tt class="py-name">True</tt><tt class="py-op">}</tt><tt class="py-op">,</tt>\ </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line">                           <tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">,</tt>\ </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line">                           <tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">,</tt>\ </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line">                           <tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">,</tt>\ </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line">                           <tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">,</tt>\ </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line">                           <tt class="py-op">{</tt><tt class="py-string">'sRel'</tt><tt class="py-op">:</tt><tt class="py-string">'$SPX'</tt><tt class="py-op">}</tt><tt class="py-op">]</tt>    </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line">         </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">lfcFeatures</tt><tt class="py-op">,</tt> <tt class="py-name">ldArgs</tt><tt class="py-op">,</tt> <tt class="py-name">lsNames</tt> </tt>
</div><a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line">           </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line"> </tt>
<a name="testFeature"></a><div id="testFeature-def"><a name="L345"></a><tt class="py-lineno">345</tt> <a class="py-toggle" href="#" id="testFeature-toggle" onclick="return toggle('testFeature');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="QSTK.qstkfeat.featutil-module.html#testFeature">testFeature</a><tt class="py-op">(</tt> <tt class="py-param">fcFeature</tt><tt class="py-op">,</tt> <tt class="py-param">dArgs</tt> <tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="testFeature-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="testFeature-expanded"><a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line">        <tt class="py-docstring">'''</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line"><tt class="py-docstring">        @summary: Quick function to run a feature on some data and plot it to see if it works.</tt> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line"><tt class="py-docstring">        @param fcFeature: Feature function to test</tt> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line"><tt class="py-docstring">        @param dArgs: Arguments to pass into feature function </tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line"><tt class="py-docstring">        @return: Void</tt> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line"><tt class="py-docstring">        '''</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line">         </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">        <tt class="py-string">''' Get Train data for 2009-2010 '''</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">        <tt class="py-name">dtStart</tt> <tt class="py-op">=</tt> <tt class="py-name">dt</tt><tt class="py-op">.</tt><tt class="py-name">datetime</tt><tt class="py-op">(</tt><tt class="py-number">2009</tt><tt class="py-op">,</tt> <tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line">        <tt class="py-name">dtEnd</tt> <tt class="py-op">=</tt> <tt class="py-name">dt</tt><tt class="py-op">.</tt><tt class="py-name">datetime</tt><tt class="py-op">(</tt><tt class="py-number">2009</tt><tt class="py-op">,</tt> <tt class="py-number">5</tt><tt class="py-op">,</tt> <tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L356"></a><tt class="py-lineno">356</tt>  <tt class="py-line">                  </tt>
<a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">        <tt class="py-string">''' Pull in current training data and test data '''</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line">        <tt class="py-name">norObj</tt> <tt class="py-op">=</tt> <tt class="py-name">da</tt><tt class="py-op">.</tt><tt id="link-73" class="py-name"><a title="QSTK.qstkutil.DataAccess
QSTK.qstkutil.DataAccess.DataAccess" class="py-name" href="#" onclick="return doclink('link-73', 'DataAccess', 'link-4');">DataAccess</a></tt><tt class="py-op">(</tt><tt class="py-string">'Norgate'</tt><tt class="py-op">)</tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line">        <tt class="py-string">''' Get 2 extra months for moving averages and future returns '''</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">        <tt class="py-name">ldtTimestamps</tt> <tt class="py-op">=</tt> <tt class="py-name">du</tt><tt class="py-op">.</tt><tt id="link-74" class="py-name"><a title="QSTK.qstkutil.dateutil.getNYSEdays" class="py-name" href="#" onclick="return doclink('link-74', 'getNYSEdays', 'link-61');">getNYSEdays</a></tt><tt class="py-op">(</tt> <tt class="py-name">dtStart</tt><tt class="py-op">,</tt> <tt class="py-name">dtEnd</tt><tt class="py-op">,</tt> <tt class="py-name">dt</tt><tt class="py-op">.</tt><tt class="py-name">timedelta</tt><tt class="py-op">(</tt><tt class="py-name">hours</tt><tt class="py-op">=</tt><tt class="py-number">16</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line">         </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">        <tt class="py-name">lsSym</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'GOOG'</tt><tt class="py-op">]</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">        <tt class="py-name">lsSym</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-string">'WMT'</tt><tt class="py-op">)</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line">        <tt class="py-name">lsSym</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-string">'$SPX'</tt><tt class="py-op">)</tt> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line">        <tt class="py-name">lsSym</tt><tt class="py-op">.</tt><tt class="py-name">sort</tt><tt class="py-op">(</tt><tt class="py-op">)</tt>             </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">         </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line">        <tt class="py-name">lsKeys</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">'open'</tt><tt class="py-op">,</tt> <tt class="py-string">'high'</tt><tt class="py-op">,</tt> <tt class="py-string">'low'</tt><tt class="py-op">,</tt> <tt class="py-string">'close'</tt><tt class="py-op">,</tt> <tt class="py-string">'volume'</tt><tt class="py-op">]</tt> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">        <tt class="py-name">ldfData</tt> <tt class="py-op">=</tt> <tt class="py-name">norObj</tt><tt class="py-op">.</tt><tt id="link-75" class="py-name"><a title="QSTK.qstkutil.DataAccess.DataAccess.get_data" class="py-name" href="#" onclick="return doclink('link-75', 'get_data', 'link-62');">get_data</a></tt><tt class="py-op">(</tt> <tt class="py-name">ldtTimestamps</tt><tt class="py-op">,</tt> <tt class="py-name">lsSym</tt><tt class="py-op">,</tt> <tt class="py-name">lsKeys</tt> <tt class="py-op">)</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">        <tt class="py-name">dData</tt> <tt class="py-op">=</tt> <tt class="py-name">dict</tt><tt class="py-op">(</tt><tt class="py-name">zip</tt><tt class="py-op">(</tt><tt class="py-name">lsKeys</tt><tt class="py-op">,</tt> <tt class="py-name">ldfData</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">        <tt class="py-name">dfPrice</tt> <tt class="py-op">=</tt> <tt class="py-name">dData</tt><tt class="py-op">[</tt><tt class="py-string">'close'</tt><tt class="py-op">]</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line"> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">        <tt class="py-comment">#print dfPrice.values                             </tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">         </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line">        <tt class="py-string">''' Generate a list of DataFrames, one for each feature, with the same index/column structure as price data '''</tt> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">        <tt class="py-name">ldfFeatures</tt> <tt class="py-op">=</tt> <tt id="link-76" class="py-name"><a title="QSTK.qstkfeat.featutil.applyFeatures" class="py-name" href="#" onclick="return doclink('link-76', 'applyFeatures', 'link-65');">applyFeatures</a></tt><tt class="py-op">(</tt> <tt class="py-name">dData</tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-name">fcFeature</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-name">dArgs</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">sMarketRel</tt><tt class="py-op">=</tt><tt class="py-string">'$SPX'</tt> <tt class="py-op">)</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line">         </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">        <tt class="py-string">''' Use last 3 months of index, to avoid lookback nans '''</tt> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line"> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line"> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">sSym</tt> <tt class="py-keyword">in</tt> <tt class="py-name">lsSym</tt><tt class="py-op">:</tt> </tt>
<a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">subplot</tt><tt class="py-op">(</tt> <tt class="py-number">211</tt> <tt class="py-op">)</tt> </tt>
<a name="L382"></a><tt class="py-lineno">382</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">plot</tt><tt class="py-op">(</tt> <tt class="py-name">ldfFeatures</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">60</tt><tt class="py-op">:</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">dfPrice</tt><tt class="py-op">[</tt><tt class="py-name">sSym</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">60</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> <tt class="py-op">)</tt> </tt>
<a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">plot</tt><tt class="py-op">(</tt> <tt class="py-name">ldfFeatures</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">60</tt><tt class="py-op">:</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">dfPrice</tt><tt class="py-op">[</tt><tt class="py-string">'$SPX'</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">60</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-name">dfPrice</tt><tt class="py-op">[</tt><tt class="py-name">sSym</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">60</tt><tt class="py-op">]</tt> <tt class="py-op">/</tt> <tt class="py-name">dfPrice</tt><tt class="py-op">[</tt><tt class="py-string">'$SPX'</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">60</tt><tt class="py-op">]</tt> <tt class="py-op">)</tt> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">legend</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">sSym</tt><tt class="py-op">,</tt> <tt class="py-string">'$SPX'</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">title</tt><tt class="py-op">(</tt><tt class="py-name">sSym</tt><tt class="py-op">)</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">subplot</tt><tt class="py-op">(</tt> <tt class="py-number">212</tt> <tt class="py-op">)</tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">plot</tt><tt class="py-op">(</tt> <tt class="py-name">ldfFeatures</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">index</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">60</tt><tt class="py-op">:</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">ldfFeatures</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">sSym</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">60</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> <tt class="py-op">)</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">title</tt><tt class="py-op">(</tt> <tt class="py-name">fcFeature</tt><tt class="py-op">.</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">                <tt class="py-name">plt</tt><tt class="py-op">.</tt><tt class="py-name">show</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line"> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line"><tt class="py-keyword">if</tt> <tt class="py-name">__name__</tt> <tt class="py-op">==</tt> <tt class="py-string">'__main__'</tt><tt class="py-op">:</tt> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line">        <tt class="py-keyword">pass</tt> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="QSTK-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >QSTK</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Mar  5 00:49:17 2012
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
